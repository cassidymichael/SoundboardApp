<Window x:Class="Soundboard.Views.SoundPickerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Soundboard.ViewModels"
        Title="Select Sound"
        Width="500" Height="400"
        MinWidth="400" MinHeight="300"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="CanResizeWithGrip"
        Background="{StaticResource SurfaceBackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header: Search and Tags -->
        <Border Grid.Row="0"
                Background="{StaticResource ElevatedSurfaceBrush}"
                BorderBrush="{StaticResource BorderLightBrush}"
                BorderThickness="0,0,0,1"
                Padding="12,10">
            <!-- Search Box -->
            <TextBox Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource SearchTextBoxStyle}"
                     Tag="Search sounds..."
                     Height="28"/>
        </Border>

        <!-- Main Content: Sound List -->
        <Border Grid.Row="1" Padding="12">
            <Grid>
                <!-- Sound List -->
                <ListBox ItemsSource="{Binding Sounds}"
                         SelectedItem="{Binding SelectedSound}"
                         Style="{StaticResource SoundListBoxStyle}"
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                         MouseDoubleClick="ListBox_MouseDoubleClick">
                    <ListBox.ItemTemplate>
                        <DataTemplate DataType="{x:Type vm:SoundEntryViewModel}">
                            <Grid Height="28">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>

                                <!-- Name -->
                                <TextBlock Grid.Column="0"
                                           Text="{Binding DisplayName}"
                                           Foreground="{StaticResource PrimaryTextBrush}"
                                           VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis"/>

                                <!-- Duration -->
                                <TextBlock Grid.Column="1"
                                           Text="{Binding DurationDisplay}"
                                           Foreground="{StaticResource SecondaryTextBrush}"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Empty State -->
                <TextBlock Text="No sounds in library. Add sounds via the Library window first."
                           Foreground="{StaticResource SecondaryTextBrush}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           TextWrapping="Wrap"
                           TextAlignment="Center"
                           Visibility="{Binding Sounds.Count, Converter={StaticResource ZeroToVisibilityConverter}}"/>
            </Grid>
        </Border>

        <!-- Footer: Actions -->
        <Border Grid.Row="2"
                Background="{StaticResource ElevatedSurfaceBrush}"
                BorderBrush="{StaticResource BorderLightBrush}"
                BorderThickness="0,1,0,0"
                Padding="12,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Browse File -->
                <Button Grid.Column="0"
                        Content="Browse File..."
                        Command="{Binding BrowseFileCommand}"
                        Style="{StaticResource SecondaryButtonStyle}"
                        MinWidth="100"/>

                <!-- Cancel -->
                <Button Grid.Column="2"
                        Content="Cancel"
                        Command="{Binding CancelCommand}"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Margin="0,0,8,0"
                        MinWidth="70"/>

                <!-- Select -->
                <Button Grid.Column="3"
                        Content="Select"
                        Command="{Binding SelectCommand}"
                        IsEnabled="{Binding SelectedSound, Converter={StaticResource NullToVisibilityConverter}}"
                        MinWidth="70"/>
            </Grid>
        </Border>
    </Grid>
</Window>
